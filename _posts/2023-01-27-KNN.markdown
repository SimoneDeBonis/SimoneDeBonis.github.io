---
# multilingual page pair id, this must pair with translations of this page. (This name must be unique)
lng_pair: id_autogeneratedsamplecontent_1
title: KNN

# post specific
# if not specified, .name will be used from _data/owner/[language].yml
#author: ""
# multiple category is not supported
category: auto generated
# multiple tag entries are possible
tags: [Data Science, theory]
# thumbnail image for post
img: ":post_pic1.jpg"
# disable comments on this page
comments_disable: true

# publish date
date: 2023-01-27 11:32:53 +0900

# seo
# if not specified, date will be used.
#meta_modify_date: 2021-08-10 11:32:53 +0900
# check the meta_common_description in _data/owner/[language].yml
#meta_description: ""

# optional
# please use the "image_viewer_on" below to enable image viewer for individual pages or posts (_posts/ or [language]/_posts folders).
# image viewer can be enabled or disabled for all posts using the "image_viewer_posts: true" setting in _data/conf/main.yml.
#image_viewer_on: true
# please use the "image_lazy_loader_on" below to enable image lazy loader for individual pages or posts (_posts/ or [language]/_posts folders).
# image lazy loader can be enabled or disabled for all posts using the "image_lazy_loader_posts: true" setting in _data/conf/main.yml.
#image_lazy_loader_on: true
# exclude from on site search
#on_site_search_exclude: true
# exclude from search engines
#search_engine_exclude: true
# to disable this page, simply set published: false or delete this file
#published: false

---

{%- comment -%} Please delete below and place your page content here {%- endcomment -%}

<!-- outline-start -->

{{ website_info_text_first }}
\begin{center}
"If it walks like a duck, quacks like a duck, then it's probably a duck"
\end{center}

Given a region of space L(X) centered on X, of volume v, the probability is approximable as p(X)v and can be estimated as:
\begin{equation*}
\hat{p}(X)v=\frac{k(X)}{N}^\text{N of instances in L(x)}_\text{N of instances}
\hspace{0.3in} \hat{p}(X)= \frac{k(X)}{Nv}
\end{equation*} 
Requires:
\begin{itemize}
\item A set of labeled records;
\item A proximity metric to compute distances/similarities;
\item k, the number o nearest neighbours (volumetric);
\item A method for using class labels of K nearest neighbours to determine the class label of the new record (e.g. majority vote).
\end{itemize}

%TODO check if true
The majority vote rule can be improved considering the inverse of the square of the distance as weight for each vote.

\vspace{0.25in}
\textbf{Voting KNN}

From $P(X)=\frac{k(x)}{Nv}$ we can build a bayes classifier with $p(\omega_i) = \frac{N_i}{N}$
\begin{equation*}
    g(x) = \begin{cases} \omega_1 \quad if \quad \frac{N_1}{N}\frac{k(X|\omega_1)}{N_1v}> \frac{N_2}{N}\frac{k(X|\omega_2)}{N_2v}\\ 
    \omega_2 \quad if \quad \frac{N_1}{N}\frac{k(X|\omega_1)}{N_1v}< \frac{N_2}{N}\frac{k(X|\omega_2)}{N_2v}  \end{cases}
\end{equation*}
So: 
\begin{equation*}
    g(x) = \begin{cases} \omega_1 \quad if \quad k(X|\omega_1)> k(X|\omega_2)\\ 
    \omega_2 \quad if \quad k(X|\omega_1)< k(X|\omega_2)  \end{cases}
\end{equation*}

\vspace{0.25in}
\textbf{Volumetric KNN}

Fixing k, the volume of the region centered in X depends on X, $P(x) = \frac{k}{Nv(x)}$

\begin{equation*}
    g(x) = \begin{cases} \omega_1 \quad if \quad \frac{N_1}{N}\frac{k}{N_1v_1(X)}> \frac{N_2}{N}\frac{k}{N_2v_2(X)}\\ 
    \omega_2 \quad if \quad\frac{N_1}{N}\frac{k}{N_1v_1(X)} < \frac{N_2}{N}\frac{k}{N_2v_2(X)}\end{cases}
\end{equation*}
So:
\begin{equation*}
    g(x) = \begin{cases} \omega_1 \quad if \quad d(X,Knn_2) > d(X,Knn_1)\\ 
    \omega_2 \quad if \quad  d(X,Knn_2) < d(X,Knn_1)  \end{cases}
\end{equation*}

where $Knn_i$ is the k-nearest-neighbor of class i
Since v(X) is a shere, its volume is proportional to the radius so:
\begin{equation*}
    g(x) = \begin{cases} \omega_1 \quad if \quad v_2(X) > v_1(X)\\ 
    \omega_2 \quad if \quad v_2(X)<v_1(X)  \end{cases}
\end{equation*}


<!-- outline-end -->

{{ website_info_text_second }}
